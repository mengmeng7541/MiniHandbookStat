<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>§ Chapter 8 Survival Analysis | A Mini Handbook of Statistical Analyses</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="§ Chapter 8 Survival Analysis | A Mini Handbook of Statistical Analyses" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="§ Chapter 8 Survival Analysis | A Mini Handbook of Statistical Analyses" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Charlotte">


<meta name="date" content="2019-04-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="nonparametric-statistics.html">
<link rel="next" href="generalized-estimating-equatio.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.16/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.16/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/dt-ext-fixedheader-1.10.16/css/fixedHeader.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedheader-1.10.16/js/dataTables.fixedHeader.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> Mini Handbook </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prepare</a></li>
<li class="chapter" data-level="1" data-path="basic-intro.html"><a href="basic-intro.html"><i class="fa fa-check"></i><b>1</b> Basic Intro</a><ul>
<li class="chapter" data-level="1.1" data-path="basic-intro.html"><a href="basic-intro.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="1.2" data-path="basic-intro.html"><a href="basic-intro.html#normality-test"><i class="fa fa-check"></i><b>1.2</b> Normality Test</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="students-t-test.html"><a href="students-t-test.html"><i class="fa fa-check"></i><b>2</b> Student’s t-test</a><ul>
<li class="chapter" data-level="2.1" data-path="students-t-test.html"><a href="students-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>2.1</b> One sample t-test</a></li>
<li class="chapter" data-level="2.2" data-path="students-t-test.html"><a href="students-t-test.html#paired-t-test"><i class="fa fa-check"></i><b>2.2</b> Paired t-test</a></li>
<li class="chapter" data-level="2.3" data-path="students-t-test.html"><a href="students-t-test.html#two-samples-t-test"><i class="fa fa-check"></i><b>2.3</b> Two samples t-test</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA</a></li>
<li class="chapter" data-level="4" data-path="chi-square-test.html"><a href="chi-square-test.html"><i class="fa fa-check"></i><b>4</b> Chi-Square Test</a><ul>
<li class="chapter" data-level="4.1" data-path="chi-square-test.html"><a href="chi-square-test.html#cross-table"><i class="fa fa-check"></i><b>4.1</b> Cross Table</a></li>
<li class="chapter" data-level="4.2" data-path="chi-square-test.html"><a href="chi-square-test.html#test-of-goodness-of-fit"><i class="fa fa-check"></i><b>4.2</b> Test of Goodness of Fit</a></li>
<li class="chapter" data-level="4.3" data-path="chi-square-test.html"><a href="chi-square-test.html#test-of-homogeneity"><i class="fa fa-check"></i><b>4.3</b> Test of Homogeneity</a></li>
<li class="chapter" data-level="4.4" data-path="chi-square-test.html"><a href="chi-square-test.html#test-of-independence"><i class="fa fa-check"></i><b>4.4</b> Test of Independence</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i><b>5</b> Regression Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="regression-analysis.html"><a href="regression-analysis.html#linear-regression"><i class="fa fa-check"></i><b>5.1</b> Linear Regression</a></li>
<li class="chapter" data-level="5.2" data-path="regression-analysis.html"><a href="regression-analysis.html#multiple-regression-analysis"><i class="fa fa-check"></i><b>5.2</b> Multiple Regression Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="regression-analysis.html"><a href="regression-analysis.html#logistic-regression-anaylsis"><i class="fa fa-check"></i><b>5.3</b> Logistic Regression Anaylsis</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>6</b> Categorical Data Analysis</a></li>
<li class="chapter" data-level="7" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html"><i class="fa fa-check"></i><b>7</b> Nonparametric Statistics</a><ul>
<li class="chapter" data-level="7.1" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>7.1</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="7.2" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html#wilcoxon-signed-ranks-test"><i class="fa fa-check"></i><b>7.2</b> Wilcoxon Signed Ranks Test</a></li>
<li class="chapter" data-level="7.3" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html#sign-test"><i class="fa fa-check"></i><b>7.3</b> Sign Test</a></li>
<li class="chapter" data-level="7.4" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html#mann-whitney-test-wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>7.4</b> Mann-Whitney Test ( Wilcoxon rank-sum test)</a></li>
<li class="chapter" data-level="7.5" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html#two-sample-kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>7.5</b> Two sample Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="7.6" data-path="nonparametric-statistics.html"><a href="nonparametric-statistics.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>7.6</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>8</b> Survival Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-estimate"><i class="fa fa-check"></i><b>8.1</b> Kaplan-Meier estimate</a></li>
<li class="chapter" data-level="8.2" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-ph-models"><i class="fa fa-check"></i><b>8.2</b> Cox PH models</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="generalized-estimating-equatio.html"><a href="generalized-estimating-equatio.html"><i class="fa fa-check"></i><b>9</b> Generalized Estimating Equatio</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Mini Handbook of Statistical Analyses</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="survival-analysis" class="section level1">
<h1><span class="header-section-number">§ Chapter 8</span> Survival Analysis</h1>
<div id="kaplan-meier-estimate" class="section level2">
<h2><span class="header-section-number">8.1</span> Kaplan-Meier estimate</h2>
<blockquote>
<p>Data：Every data set used is found in the package KMsurv, which are the data sets from Klein and Moeschberger’s book.</p>
</blockquote>
<blockquote>
<p>install.packages(‘survival’)<br />
install.packages(‘KMsurv’)<br />
install.packages(‘DT’) install.packages(‘survminer’)</p>
</blockquote>
<blockquote>
<p>This tongue data frame has 80 rows and 3 columns:<br />
type: Tumor DNA profile (1=Aneuploid Tumor, 2=Diploid Tumor)<br />
time: Time to death or on-study time, weeks<br />
delta: Death indicator (0=alive, 1=dead)</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(tongue)

DT<span class="op">::</span><span class="kw">datatable</span>(tongue, 
    <span class="dt">extensions =</span> <span class="kw">c</span>(<span class="st">&#39;FixedColumns&#39;</span>,<span class="st">&quot;FixedHeader&quot;</span>),
    <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">scrollX =</span> <span class="ot">TRUE</span>, <span class="dt">paging=</span><span class="ot">TRUE</span>, <span class="dt">fixedHeader=</span><span class="ot">TRUE</span>))</code></pre></div>
<div id="htmlwidget-de29569613a5ab0e4592" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-de29569613a5ab0e4592">{"x":{"filter":"none","extensions":["FixedColumns","FixedHeader"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],[1,3,3,4,10,13,13,16,16,24,26,27,28,30,30,32,41,51,65,67,70,72,73,77,91,93,96,100,104,157,167,61,74,79,80,81,87,87,88,89,93,97,101,104,108,109,120,131,150,231,240,400,1,3,4,5,5,8,12,13,18,23,26,27,30,42,56,62,69,104,104,112,129,181,8,67,76,104,176,231],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>time<\/th>\n      <th>delta<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":true,"fixedHeader":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(tongue)
my.surv &lt;-<span class="st"> </span><span class="kw">Surv</span>(time[type<span class="op">==</span><span class="dv">1</span>], delta[type<span class="op">==</span><span class="dv">1</span>])
my.surv</code></pre></div>
<pre><code>##  [1]   1    3    3    4   10   13   13   16   16   24   26   27   28   30 
## [15]  30   32   41   51   65   67   70   72   73   77   91   93   96  100 
## [29] 104  157  167   61+  74+  79+  80+  81+  87+  87+  88+  89+  93+  97+
## [43] 101+ 104+ 108+ 109+ 120+ 131+ 150+ 231+ 240+ 400+</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.fit &lt;-<span class="st"> </span><span class="kw">survfit</span>(my.surv <span class="op">~</span><span class="st"> </span><span class="dv">1</span> )
<span class="kw">summary</span>(my.fit)</code></pre></div>
<pre><code>## Call: survfit(formula = my.surv ~ 1)
## 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     1     52       1    0.981  0.0190        0.944        1.000
##     3     51       2    0.942  0.0323        0.881        1.000
##     4     49       1    0.923  0.0370        0.853        0.998
##    10     48       1    0.904  0.0409        0.827        0.988
##    13     47       2    0.865  0.0473        0.777        0.963
##    16     45       2    0.827  0.0525        0.730        0.936
##    24     43       1    0.808  0.0547        0.707        0.922
##    26     42       1    0.788  0.0566        0.685        0.908
##    27     41       1    0.769  0.0584        0.663        0.893
##    28     40       1    0.750  0.0600        0.641        0.877
##    30     39       2    0.712  0.0628        0.598        0.846
##    32     37       1    0.692  0.0640        0.578        0.830
##    41     36       1    0.673  0.0651        0.557        0.813
##    51     35       1    0.654  0.0660        0.537        0.797
##    65     33       1    0.634  0.0669        0.516        0.780
##    67     32       1    0.614  0.0677        0.495        0.762
##    70     31       1    0.594  0.0683        0.475        0.745
##    72     30       1    0.575  0.0689        0.454        0.727
##    73     29       1    0.555  0.0693        0.434        0.709
##    77     27       1    0.534  0.0697        0.414        0.690
##    91     19       1    0.506  0.0715        0.384        0.667
##    93     18       1    0.478  0.0728        0.355        0.644
##    96     16       1    0.448  0.0741        0.324        0.620
##   100     14       1    0.416  0.0754        0.292        0.594
##   104     12       1    0.381  0.0767        0.257        0.566
##   157      5       1    0.305  0.0918        0.169        0.550
##   167      4       1    0.229  0.0954        0.101        0.518</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(my.fit, <span class="dt">main=</span><span class="st">&quot;Kaplan-Meier estimate with 95% confidence bounds&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;survival function&quot;</span>)</code></pre></div>
<p><img src="Charlotte_Statistics_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># hazard function</span>
H.hat&lt;-<span class="op">-</span><span class="kw">log</span>(my.fit<span class="op">$</span>surv)

<span class="kw">print</span>(my.fit, <span class="dt">print.rmean=</span><span class="ot">TRUE</span>) </code></pre></div>
<pre><code>## Call: survfit(formula = my.surv ~ 1)
## 
##          n     events     *rmean *se(rmean)     median    0.95LCL 
##       52.0       31.0      146.6       27.7       93.0       67.0 
##    0.95UCL 
##         NA 
##     * restricted mean with upper limit =  400</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#compare type=1 and type=2</span>
my.fit1&lt;-<span class="kw">survfit</span>(<span class="kw">Surv</span>(time,delta)<span class="op">~</span>type, <span class="dt">data=</span>tongue)
<span class="kw">print</span>(my.fit1)</code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time, delta) ~ type, data = tongue)
## 
##         n events median 0.95LCL 0.95UCL
## type=1 52     31     93      67      NA
## type=2 28     22     42      23     112</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsurvplot</span>(my.fit1, <span class="dt">pval =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">risk.table =</span> <span class="ot">TRUE</span>, 
           <span class="dt">ggtheme =</span> <span class="kw">theme_bw</span>(), <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#2E9FDF&quot;</span>))</code></pre></div>
<p><img src="Charlotte_Statistics_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Tests for two or more samples</span>
<span class="kw">survdiff</span>(<span class="kw">Surv</span>(time, delta) <span class="op">~</span><span class="st"> </span>type) <span class="co"># output omitted</span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time, delta) ~ type)
## 
##         N Observed Expected (O-E)^2/E (O-E)^2/V
## type=1 52       31     36.6     0.843      2.79
## type=2 28       22     16.4     1.873      2.79
## 
##  Chisq= 2.8  on 1 degrees of freedom, p= 0.09</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(tongue)</code></pre></div>
</div>
<div id="cox-ph-models" class="section level2">
<h2><span class="header-section-number">8.2</span> Cox PH models</h2>
<blockquote>
<p>Mayo Clinic Primary Biliary Cirrhosis Data<br />
Followup of 312 randomised patients with primary biliary cirrhosis, a rare autoimmune liver disease, at Mayo Clinic.</p>
<p>install.packages(‘JM’)</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(years, status2) <span class="op">~</span><span class="st"> </span>drug <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> pbc2.id)
<span class="kw">summary</span>(fit)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(years, status2) ~ drug + sex + age, data = pbc2.id)
## 
##   n= 312, number of events= 140 
## 
##                    coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## drugD-penicil -0.146013  0.864146  0.172143 -0.848   0.3963    
## sexfemale     -0.470905  0.624437  0.221785 -2.123   0.0337 *  
## age            0.042842  1.043773  0.008505  5.037 4.72e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##               exp(coef) exp(-coef) lower .95 upper .95
## drugD-penicil    0.8641     1.1572    0.6167    1.2109
## sexfemale        0.6244     1.6014    0.4043    0.9644
## age              1.0438     0.9581    1.0265    1.0613
## 
## Concordance= 0.629  (se = 0.024 )
## Rsquare= 0.101   (max possible= 0.991 )
## Likelihood ratio test= 33.25  on 3 df,   p=3e-07
## Wald test            = 34.87  on 3 df,   p=1e-07
## Score (logrank) test = 35.31  on 3 df,   p=1e-07</code></pre>
<blockquote>
<p>Survival in patients with advanced lung cancer from the North Central Cancer Treatment Group. Performance scores rate how well the patient can perform usual daily activities.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DT<span class="op">::</span><span class="kw">datatable</span>(lung, 
    <span class="dt">extensions =</span> <span class="kw">c</span>(<span class="st">&#39;FixedColumns&#39;</span>,<span class="st">&quot;FixedHeader&quot;</span>), <span class="dt">rownames =</span> <span class="ot">FALSE</span>,
    <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">scrollX =</span> <span class="ot">TRUE</span>, <span class="dt">paging=</span><span class="ot">TRUE</span>, <span class="dt">fixedHeader=</span><span class="ot">TRUE</span>))</code></pre></div>
<div id="htmlwidget-a5eac3f1eb8881365b26" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a5eac3f1eb8881365b26">{"x":{"filter":"none","extensions":["FixedColumns","FixedHeader"],"data":[[3,3,3,5,1,12,7,11,1,7,6,16,11,21,12,1,22,16,1,21,11,6,11,15,12,12,4,13,13,1,12,1,7,16,12,1,22,15,1,1,5,11,10,12,7,7,1,3,13,22,3,12,21,1,6,1,5,22,3,1,22,12,21,11,3,3,16,5,22,6,13,3,5,2,21,12,1,6,3,1,4,13,11,21,16,6,22,21,13,1,11,22,5,10,1,12,3,12,11,3,1,6,13,6,13,12,26,1,21,3,13,1,10,3,6,1,3,1,16,15,22,26,3,11,1,22,7,12,16,12,4,16,6,13,1,22,12,13,1,5,21,3,26,1,11,26,16,16,12,13,13,22,5,16,32,null,26,4,12,1,32,10,11,6,7,16,11,21,6,12,13,2,2,16,1,13,1,13,1,7,13,1,16,32,12,12,2,3,15,22,16,16,12,1,22,12,32,21,1,32,15,22,32,3,26,33,5,13,21,33,1,6,15,11,11,11,13,21,11,2,22,11,1,1,13,32,6,22],[306,455,1010,210,883,1022,310,361,218,166,170,654,728,71,567,144,613,707,61,88,301,81,624,371,394,520,574,118,390,12,473,26,533,107,53,122,814,965,93,731,460,153,433,145,583,95,303,519,643,765,735,189,53,246,689,65,5,132,687,345,444,223,175,60,163,65,208,821,428,230,840,305,11,132,226,426,705,363,11,176,791,95,196,167,806,284,641,147,740,163,655,239,88,245,588,30,179,310,477,166,559,450,364,107,177,156,529,11,429,351,15,181,283,201,524,13,212,524,288,363,442,199,550,54,558,207,92,60,551,543,293,202,353,511,267,511,371,387,457,337,201,404,222,62,458,356,353,163,31,340,229,444,315,182,156,329,364,291,179,376,384,268,292,142,413,266,194,320,181,285,301,348,197,382,303,296,180,186,145,269,300,284,350,272,292,332,285,259,110,286,270,81,131,225,269,225,243,279,276,135,79,59,240,202,235,105,224,239,237,173,252,221,185,92,13,222,192,183,211,175,197,203,116,188,191,105,174,177],[2,2,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,1,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,1,1,2,2,2,1,2,2,1,1,2,1,2,1,1,2,2,2,2,1,2,2,1,1,1,2,2,2,1,1,1,2,1,1,1,2,1,2,2,2,2,2,1,2,1,1,1,1,2,2,2,1,1,1,2,1,2,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,1,1],[74,68,56,57,60,74,68,71,53,61,57,68,68,60,57,67,70,63,56,57,67,49,50,58,72,70,60,70,53,74,69,73,48,60,61,62,65,66,74,64,70,73,59,60,68,76,74,63,74,50,72,63,68,58,59,62,65,57,58,64,75,48,73,65,69,68,67,64,68,67,63,48,74,40,53,71,51,56,81,73,59,55,42,44,44,71,62,61,44,72,63,70,66,57,69,72,69,71,64,70,58,69,56,63,59,66,54,67,55,75,69,44,80,75,54,76,49,68,66,80,75,60,69,72,70,66,50,64,77,48,59,53,47,55,67,74,58,56,54,56,73,74,76,65,57,53,71,54,82,59,70,60,62,53,55,69,68,62,63,56,62,44,69,63,64,57,60,46,61,65,61,58,56,43,53,59,56,55,53,74,60,39,66,65,51,45,72,58,64,53,72,52,50,64,71,70,63,64,52,60,64,73,63,50,63,62,55,50,69,59,60,67,69,64,65,65,41,76,70,57,67,71,76,77,39,75,66,58],[1,1,1,1,1,1,2,2,1,1,1,2,2,1,1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,2,1,1,2,1,2,1,2,1,2,1,2,2,2,1,2,1,1,1,2,2,1,1,1,1,1,2,1,2,2,2,1,1,2,1,1,2,2,1,1,1,2,1,1,2,2,2,2,1,1,1,1,1,2,1,1,2,1,2,1,1,1,1,2,2,1,1,1,1,2,2,2,1,1,1,1,2,1,1,2,1,1,1,2,2,1,1,1,1,1,1,2,2,1,1,1,1,1,2,2,2,1,1,2,1,2,2,1,1,1,2,1,1,2,1,2,1,1,1,2,1,1,2,2,1,1,2,1,1,2,2,2,1,1,1,2,2,1,1,1,1,2,1,2,1,2,1,2,2,2,1,1,2,2,2,2,2,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,2,2,2,1,2,2,1,2,2,1,1,2,1,1,2,1,2,2,1,2,1,1,1,2,1,2],[1,0,0,1,0,1,2,2,1,2,1,2,1,null,1,1,1,2,2,1,1,0,1,0,0,1,0,3,1,2,1,2,2,2,2,2,2,1,2,1,1,2,0,2,1,2,0,1,0,1,1,0,0,0,1,0,0,2,1,1,2,1,1,1,1,2,2,0,0,1,0,1,2,1,1,1,0,1,0,0,0,1,1,1,1,1,1,0,1,2,0,1,1,1,0,2,1,1,1,0,0,1,1,1,2,1,1,1,1,2,0,1,1,0,1,2,2,2,2,1,0,2,1,2,0,1,1,1,2,0,1,1,0,1,0,2,1,2,1,0,2,1,2,1,1,1,0,1,0,0,1,0,0,1,2,2,1,2,1,1,0,1,2,1,1,0,1,0,1,0,1,0,1,0,1,1,2,1,1,0,0,0,0,1,0,0,2,0,1,0,1,2,1,1,1,0,1,1,0,1,1,1,0,0,0,2,0,2,1,1,0,1,1,2,1,1,1,2,2,0,1,1,1,1,0,2,1,1],[90,90,90,90,100,50,70,60,70,70,80,70,90,60,80,80,90,50,60,90,80,100,70,90,90,90,100,60,80,70,90,60,60,50,70,50,70,70,50,80,80,60,90,70,60,60,90,80,90,90,90,80,90,100,90,90,100,70,80,90,70,90,80,90,80,70,70,90,100,80,90,80,70,80,90,90,100,80,90,90,100,70,80,80,80,80,80,100,90,70,100,80,90,80,100,80,80,90,90,90,100,80,70,90,50,80,80,90,100,60,90,80,80,90,80,70,70,60,70,80,90,70,70,60,90,80,80,80,80,90,80,80,100,80,90,60,80,80,90,100,70,80,70,80,80,90,100,90,100,100,70,90,90,80,70,70,90,70,80,80,90,90,60,90,80,90,80,100,90,100,90,90,90,100,90,80,60,80,80,100,100,100,90,80,90,90,70,90,80,90,80,60,90,90,90,100,80,90,100,90,90,60,90,100,100,null,80,60,80,90,100,80,90,70,80,90,90,80,70,80,80,80,80,80,90,60,90,80],[100,90,90,60,90,80,60,80,80,70,80,70,90,70,70,90,100,70,60,80,80,70,80,100,80,80,100,70,70,50,90,70,80,60,100,50,60,90,40,100,60,70,90,60,70,60,70,70,90,100,90,70,100,90,80,80,80,60,80,80,70,80,100,80,60,50,null,70,80,100,90,90,100,80,80,90,80,70,null,70,80,90,80,90,80,90,80,90,80,70,90,100,80,60,90,60,80,100,100,70,100,90,80,70,null,90,100,90,80,50,70,90,100,100,100,70,60,70,60,90,90,80,80,60,90,80,60,90,60,60,80,80,90,70,70,40,70,60,90,100,60,70,70,90,100,90,80,80,90,90,60,100,90,60,30,80,90,60,70,90,90,100,70,80,70,90,60,100,90,90,100,80,60,90,80,100,80,70,90,100,100,90,100,90,80,100,90,80,60,90,90,70,80,80,90,100,90,90,80,70,90,60,100,100,90,70,90,60,70,80,90,70,70,100,90,70,80,60,30,80,90,90,80,60,90,70,100,90],[1175,1225,null,1150,null,513,384,538,825,271,1025,null,null,1225,2600,null,1150,1025,238,1175,1025,1175,null,975,null,825,1025,1075,875,305,1025,388,null,925,1075,1025,513,875,1225,1175,975,1075,363,null,1025,625,463,1025,1425,1175,null,null,1025,1175,1300,725,338,null,1225,1075,438,1300,1025,1025,1125,825,538,1025,1039,488,1175,538,1175,null,825,1075,1300,1225,731,169,768,1500,1425,588,1025,1100,1150,1175,588,910,975,null,875,280,null,288,null,null,910,null,710,1175,null,null,null,875,975,925,975,925,575,1175,1030,null,null,413,675,1300,613,346,null,675,910,768,1025,925,1075,993,750,null,925,null,1225,null,313,96,null,1075,975,1500,1225,413,1500,1075,513,null,775,1225,413,null,1175,null,null,null,1025,713,null,475,538,825,588,2450,2450,875,413,1075,null,860,730,1025,825,1225,768,338,1225,1025,1225,null,588,588,975,1225,1025,null,1225,975,463,1300,1025,1225,488,1075,513,825,1300,1175,825,null,975,1275,488,2200,1025,635,413,null,null,1025,null,null,488,413,1075,null,null,1025,null,825,131,725,1500,1025,null,null,2350,1025,1075,1060],[null,15,15,11,0,0,10,1,16,34,27,23,5,32,60,15,-5,22,10,null,17,-8,16,13,0,6,-13,20,-7,20,-1,20,-11,-15,10,null,28,4,24,15,10,11,27,null,7,-24,30,10,2,4,9,0,0,7,15,null,5,18,10,-3,8,68,null,0,0,8,2,3,0,23,-1,29,0,3,3,19,0,-2,15,30,5,15,8,-1,1,14,1,4,39,2,-1,23,8,14,13,7,25,0,0,10,15,3,4,0,32,14,-3,null,5,11,10,5,6,1,15,20,20,30,24,11,0,10,0,-3,17,20,13,0,28,4,52,20,5,49,6,37,0,null,-5,15,-16,38,8,0,30,2,2,13,27,0,-2,7,0,4,10,20,7,27,-2,17,8,2,36,2,16,3,33,4,0,0,2,10,37,6,12,0,-2,null,13,0,5,-5,null,-1,0,5,20,8,12,8,14,null,null,33,-2,6,0,4,0,0,37,5,0,1,0,null,23,-3,null,10,-2,23,0,31,10,18,-10,7,3,11,2,0,0,3,-5,5,1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>inst<\/th>\n      <th>time<\/th>\n      <th>status<\/th>\n      <th>age<\/th>\n      <th>sex<\/th>\n      <th>ph.ecog<\/th>\n      <th>ph.karno<\/th>\n      <th>pat.karno<\/th>\n      <th>meal.cal<\/th>\n      <th>wt.loss<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"paging":true,"fixedHeader":true,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survdiff</span>(<span class="kw">Surv</span>(time,status<span class="op">==</span><span class="dv">1</span>)<span class="op">~</span>sex, <span class="dt">data=</span>lung)</code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time, status == 1) ~ sex, data = lung)
## 
##         N Observed Expected (O-E)^2/E (O-E)^2/V
## sex=1 138       26     35.6      2.60      6.23
## sex=2  90       37     27.4      3.39      6.23
## 
##  Chisq= 6.2  on 1 degrees of freedom, p= 0.01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># predict male survival from age and medical scores</span>
MaleMod &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time,status)<span class="op">~</span>age<span class="op">+</span>ph.ecog<span class="op">+</span>ph.karno<span class="op">+</span>pat.karno,
  <span class="dt">data=</span>lung, <span class="dt">subset=</span>sex<span class="op">==</span><span class="dv">1</span>)
<span class="co"># display results</span>
<span class="kw">summary</span>(MaleMod)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ age + ph.ecog + ph.karno + 
##     pat.karno, data = lung, subset = sex == 1)
## 
##   n= 134, number of events= 108 
##    (4 observations deleted due to missingness)
## 
##                coef exp(coef)  se(coef)      z Pr(&gt;|z|)   
## age        0.022465  1.022719  0.012216  1.839   0.0659 . 
## ph.ecog    0.665452  1.945370  0.225712  2.948   0.0032 **
## ph.karno   0.025553  1.025883  0.011778  2.170   0.0300 * 
## pat.karno -0.011059  0.989002  0.008892 -1.244   0.2136   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##           exp(coef) exp(-coef) lower .95 upper .95
## age           1.023     0.9778    0.9985     1.048
## ph.ecog       1.945     0.5140    1.2499     3.028
## ph.karno      1.026     0.9748    1.0025     1.050
## pat.karno     0.989     1.0111    0.9719     1.006
## 
## Concordance= 0.617  (se = 0.031 )
## Rsquare= 0.125   (max possible= 0.998 )
## Likelihood ratio test= 17.87  on 4 df,   p=0.001
## Wald test            = 18.3  on 4 df,   p=0.001
## Score (logrank) test = 18.6  on 4 df,   p=9e-04</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">survfit</span>(MaleMod))</code></pre></div>
<p><img src="Charlotte_Statistics_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>Holding the other covariates constant, an additional year of age reduces the weekly hazard of rearrest by a factor of <span class="math inline">\(e^{0.0225}　= 1.022719\)</span> on average.</li>
<li>Each ph.ecog increases the hazard by a factor of 1.945370 on average.</li>
<li>The likelihood ratio test is a equivalent tests of the omnibus null hypothesis that all of the <span class="math inline">\(\beta&#39;s\)</span> are zero. In this instance, the hypothesis is soundly rejected.</li>
<li>So we can obtain Cox proportional hazards model as follows:<br />
<span class="math inline">\(h(t,x)=h_0(t)+exp(0.0225age+0.6655ph.ecog+0.0256ph.karno-0.011pat.karno)\)</span></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nonparametric-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-estimating-equatio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Charlotte_Statistics.pdf", "Charlotte_Statistics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
